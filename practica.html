<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Pr√°ctica - Juego de Se√±ales</title>
  <link rel="icon" type="image/png" href="ucv.png">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="practica.css">
  <style>
    .return-button {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      text-decoration: none;
    }

    .return-button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <!-- Agregar cabecera con logo -->
    <header class="top-nav">
        <div class="container">
            <div class="logo-container">
                <img src="ucv.png" alt="Logo UCV" class="logo">
                <span class="university-name">Universidad C√©sar Vallejo</span>
            </div>
        </div>
    </header>
  <!-- START: nueva estructura de dashboard en pr√°ctica -->
  <main class="practice-dashboard container">
    <!-- Columna izquierda: men√∫ vertical dentro del contenedor -->
    <section class="practice-main">
      <div class="practice-inner-grid">
        <nav class="practice-menu" aria-label="Navegaci√≥n pr√°ctica">
          <!-- Menu como tarjetas (sin cambios en el markup de botones) -->
          <button class="menu-card" data-target="section-cursos" id="menuCursos" type="button" aria-pressed="false">
            <div class="card-icon">üñºÔ∏è</div>
            <h3 class="card-title">Galer√≠a</h3>
            <p class="card-desc">Explora el vocabulario de se√±as</p>
          </button>

          <button class="menu-card" data-target="section-crear" id="menuCrear" type="button" aria-pressed="false">
            <div class="card-icon">‚úçÔ∏è</div>
            <h3 class="card-title">Crear Cursos</h3>
            <p class="card-desc">Dise√±a tu propio curso</p>
          </button>

          <button class="menu-card" data-target="section-practica" id="menuPractica" type="button" aria-pressed="false">
            <div class="card-icon">‚úèÔ∏è</div>
            <h3 class="card-title">Pr√°ctica</h3>
            <p class="card-desc">Pon a prueba tus conocimientos</p>
          </button>

          <button class="menu-card" data-target="section-documentos" id="menuDocumentos" onclick="window.location.href='comunicacion.html'" type="button">
            <div class="card-icon">üìÑ</div>
            <h3 class="card-title">Documentos</h3>
            <p class="card-desc">Material descargable</p>
          </button>

          <button class="menu-card" data-target="section-records" id="menuRecords" type="button" aria-pressed="false">
            <div class="card-icon">üìä</div>
            <h3 class="card-title">Records</h3>
            <p class="card-desc">Tus mejores puntajes</p>
          </button>

          <button class="menu-card" data-target="section-logros" id="menuLogros" type="button" aria-pressed="false">
            <div class="card-icon">üèÜ</div>
            <h3 class="card-title">Logros</h3>
            <p class="card-desc">Insignias y avances</p>
          </button>
        </nav>

        <!-- Contenido: cada secci√≥n muestra su propio contenido -->
        <div class="practice-content">
          <!-- Secci√≥n Cursos -->
          <div id="section-cursos" class="menu-section hidden">
            <!-- contenido corto de ejemplo, puedes ampliarlo -->
            <h2>Cursos</h2>
            <p>Lista de cursos disponibles...</p>
          </div>

          <!-- Secci√≥n Crear Cursos -->
          <div id="section-crear" class="menu-section hidden">
            <h2>Crear Cursos</h2>
            <p>Formulario para crear un curso...</p>
          </div>

          <!-- Secci√≥n Pr√°ctica (contiene el juego) -->
          <div id="section-practica" class="menu-section hidden">
            <!-- Aqu√≠ se mantiene tu contenido existente del juego -->
            <div class="practice-game-wrap">
              <div class="center">
                <div id="game" class="hidden">
                  <div style="display:flex;align-items:center;gap:12px;justify-content:center">
                    <div style="width:300px">
                      <div style="display:flex;align-items:center;justify-content:space-between">
                        <div>Ronda: <span id="round">0</span>/10</div>
                        <div>Correctas: <span id="correct">0</span></div>
                        <div>Malas: <span id="wrong">0</span></div>
                      </div>
                      <div class="timer-wrap" aria-hidden="false">
                        <div id="timerBar" class="timer-bar"></div>
                      </div>
                    </div>
                    <div class="time-text" id="timeText">00:30</div>
                  </div>

                  <div class="game-area">
                    <img id="questionImg" class="question-img" src="" alt="Pregunta">
                    <div class="options" id="optionsContainer">
                      <!-- 3 opciones se insertan din√°micamente -->
                    </div>

                    <div class="feedback" id="feedback"></div>

                    <div style="margin-top:8px">¬øQu√© se√±al es esta?</div>
                  </div>
                </div>

                <div id="endResult" class="result hidden"></div>
              </div>
            </div>
          </div>

          <!-- Secci√≥n Documentos -->
          <div id="section-documentos" class="menu-section hidden">
            <h2>Documentos</h2>
            <p>Material descargable y documentos...</p>
          </div>

          <!-- Secci√≥n Records -->
          <div id="section-records" class="menu-section hidden">
            <h2>Records</h2>
            <p>Tus mejores puntajes y estad√≠sticas...</p>
          </div>

          <!-- Secci√≥n Logros -->
          <div id="section-logros" class="menu-section hidden">
            <h2>Logros</h2>
            <p>Tus insignias y avances...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Columna derecha: perfil (foto, nombre, nivel + barras de progreso) -->
    <aside class="practice-sidebar">
      <div class="profile-container">
        <div class="profile-header">
          <div class="profile-image-container" id="profileImageContainer">
            <img id="userProfilePic" src="https://ui-avatars.com/api/?name=U&background=4285F4&color=fff" alt="Foto de perfil">
          </div>
          <h2 id="userName">Cargando...</h2>
          <div id="userLevel" class="user-level">Nivel: <span id="levelValue">1</span>/500</div>
        </div>

        <div class="profile-progress">
          <div class="progress-wrap">
            <div class="progress-label">Record</div>
            <div class="progress">
              <div id="recordBar" class="bar" style="width:0%"></div>
            </div>
            <div class="progress-meta"><span id="recordPercent">0%</span></div>
          </div>
          <div class="progress-wrap" style="margin-top:12px;">
            <div class="progress-label">Logros</div>
            <div class="progress">
              <div id="logrosBar" class="bar" style="width:0%"></div>
            </div>
            <div class="progress-meta"><span id="logrosPercent">0%</span></div>
          </div>
        </div>

        <!-- Bot√≥n volver ahora en el perfil -->
        <a href="seleccion.html" class="return-link">Volver</a>
      </div>
    </aside>
  </main>
  <!-- END: nueva estructura de dashboard en pr√°ctica -->

  <!-- Script para manejar men√∫, bot√≥n "Pr√°ctica" y perfil -->
  <script>
    (function(){
      const contentTitle = document.createElement('h2');
      contentTitle.className = 'content-title';
      document.querySelector('.practice-content').prepend(contentTitle);

      function showSection(id, title) {
        document.querySelectorAll('.menu-section').forEach(s => s.classList.add('hidden'));
        const el = document.getElementById(id);
        if (el) el.classList.remove('hidden');
        contentTitle.textContent = title;
      }

      document.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.practice-menu .menu-card').forEach(btn=>{
          btn.addEventListener('click', function(){
            const target = btn.dataset.target;
            const title = btn.querySelector('.card-title').textContent;
            if (!target) return;

            showSection(target, title);

            document.querySelectorAll('.practice-menu .menu-card').forEach(c=> c.classList.remove('active'));
            btn.classList.add('active');

            if (target === 'section-practica' && typeof window.startGame === 'function') {
              window.startGame();
            }
          });
        });

        // Mostrar Galer√≠a por defecto
        const first = document.querySelector('.practice-menu .menu-card');
        if (first) {
          first.classList.add('active');
          const t = first.dataset.target;
          const title = first.querySelector('.card-title').textContent;
          if (t) showSection(t, title);
        }
      });
    })();
  </script>

  <!-- Nuevo: script para cargar perfil desde localStorage y dibujar hojas -->
  <script>
    // filepath: c:\Users\01\programming\practica.html (profile loader)
    (function(){
      function addLeaves(level) {
        const container = document.getElementById('profileImageContainer');
        if (!container) return;
        const maxLeaves = 24;
        const lvl = Math.max(1, Math.min(500, Number(level) || 1));
        const leavesCount = Math.max(1, Math.round((lvl / 500) * maxLeaves));
        container.querySelectorAll('.leaf').forEach(n => n.remove());
        for (let i = 0; i < leavesCount; i++) {
          const leaf = document.createElement('div');
          leaf.className = 'leaf';
          const angle = (i * 360 / leavesCount);
          leaf.style.left = '50%';
          leaf.style.top = '50%';
          leaf.style.transform = `translate(-50%, -50%) rotate(${angle}deg) translateY(-86px) rotate(${angle > 180 ? 180-angle : -angle}deg)`;
          container.appendChild(leaf);
        }
      }

      function loadProfile() {
        const currentEmail = localStorage.getItem('currentUser');
        const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
        const user = currentEmail ? users[currentEmail] : null;
        const picEl = document.getElementById('userProfilePic');
        const nameEl = document.getElementById('userName');
        const levelEl = document.getElementById('levelValue');
        if (user) {
          if (picEl) picEl.src = user.picture || (`https://ui-avatars.com/api/?name=${encodeURIComponent(user.name||user.email||'U')}&background=4285F4&color=fff`);
          if (nameEl) nameEl.textContent = user.name || user.email || 'Usuario';
        } else {
          if (picEl) picEl.src = 'https://ui-avatars.com/api/?name=I&background=888888&color=fff';
          if (nameEl) nameEl.textContent = 'Invitado';
        }
        const storedLevel = Number(localStorage.getItem('userLevel') || 1);
        if (levelEl) levelEl.textContent = Math.max(1, Math.min(500, storedLevel));
        addLeaves(storedLevel);
        const recordPct = Number(localStorage.getItem('userRecordPct') || 0);
        const logrosPct = Number(localStorage.getItem('userLogrosPct') || 0);
        const rb = document.getElementById('recordBar'), rp = document.getElementById('recordPercent');
        const lb = document.getElementById('logrosBar'), lp = document.getElementById('logrosPercent');
        if (rb) rb.style.width = Math.min(100, Math.max(0, recordPct)) + '%';
        if (rp) rp.textContent = Math.round(recordPct) + '%';
        if (lb) lb.style.width = Math.min(100, Math.max(0, logrosPct)) + '%';
        if (lp) lp.textContent = Math.round(logrosPct) + '%';
      }

      document.addEventListener('DOMContentLoaded', loadProfile);
      // permitir revalidar desde consola
      window.reloadPracticeProfile = loadProfile;
    })();
  </script>

  <!-- Scripts: mantiene practica.js solo -->
  <script src="practica.js"></script>
</body>
</html>

